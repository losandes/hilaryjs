/*! hilary-build 2015-06-22 */
!function(a,b){"use strict";if(a.Hilary)return!1;var c,d,e,f,g,h,i,j,k,l=[],m={},n=[];g={containerRegistration:"hilary::container",parentContainerRegistration:"hilary::parent",singletons:"__singletons",notResolvable:"hilary::handler::not::resolvable",pipeline:{beforeRegister:"hilary::before::register",afterRegister:"hilary::after::register",beforeResolve:"hilary::before::resolve",afterResolve:"hilary::after::resolve",beforeNewChild:"hilary::before::new::child",afterNewChild:"hilary::after::new::child",onError:"hilary::error"}},h=function(){var a,b,c={},d=Object.prototype,e=d.toString,f=(d.hasOwnProperty,{}),g=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(a=0;a<g.length;a+=1)b=g[a],f["[object "+b+"]"]=b.toLowerCase();return c.type=function(a){return"undefined"==typeof a?"undefined":null===a?String(a):"object"==typeof a||"function"==typeof a?f[e.call(a)]||"object":typeof a},c.notDefined=function(a){try{return"undefined"===this.type(a)}catch(b){return!0}},c.isDefined=function(a){try{return"undefined"!==this.type(a)}catch(b){return!1}},c.isFunction=function(a){return"function"===this.type(a)},c.notFunction=function(a){return"function"!==this.type(a)},c.isObject=function(a){return"object"===this.type(a)},c.notObject=function(a){return"object"!==this.type(a)},c.isArray=function(a){return"array"===this.type(a)},c.notArray=function(a){return"array"!==this.type(a)},c.isString=function(a){return"string"===this.type(a)},c.notString=function(a){return"string"!==this.type(a)},c.isBoolean=function(a){return"boolean"===this.type(a)},c.notBoolean=function(a){return"boolean"!==this.type(a)},c.notNullOrWhitespace=function(a){if(!a)return!1;if(this.notString(a))throw new Error("Unable to check if a non-string is whitespace.");return/([^\s])/.test(a)},c.isNullOrWhitespace=function(a){return this.notNullOrWhitespace(a)===!1},c.createGuid=function(){return"zxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},c},i=new h,j=function(a,b){var c,d={};return c=function(c,d,e){var f=a.isString(d)?d:c,g=new Error(f);return g.message=f,c!==f&&(g.name=c),e&&(g.data=e),b.onError(g),g},d.makeException=c,d.argumentException=function(b,d,e){var f=a.notDefined(d)?b:b+" (argument: "+d+")";return c("ArgumentException",f,e)},d.dependencyException=function(b,d,e){var f=a.notDefined(d)?b:b+" (dependency: "+d+"). If the module exists, does it return a value?";return c("DependencyException",f,e)},d.notImplementedException=function(a,b){return c("NotImplementedException",a,b)},d.notResolvableException=function(a){return d.dependencyException("The module cannot be resolved",a)},d},e=function(){var a={};return a.beforeRegisterEvents=[],a.afterRegisterEvents=[],a.beforeResolveEvents=[],a.afterResolveEvents=[],a.beforeNewChildEvents=[],a.afterNewChildEvents=[],a.onError=[],a},f=function(a,b){var c,d,f,h,i,j,k,l,m,n={},o=new e;return c=function(b,c){switch(b){case g.pipeline.beforeRegister:return o.beforeRegisterEvents.push(c),a;case g.pipeline.afterRegister:return o.afterRegisterEvents.push(c),a;case g.pipeline.beforeResolve:return o.beforeResolveEvents.push(c),a;case g.pipeline.afterResolve:return o.afterResolveEvents.push(c),a;case g.pipeline.beforeNewChild:return o.beforeNewChildEvents.push(c),a;case g.pipeline.afterNewChild:return o.afterNewChildEvents.push(c),a;case g.pipeline.onError:return o.onError.push(c),a;default:throw new Error("the pipeline event you are trying to register is not implemented (name: "+b+")")}},d=function(a,c){var d,e;for(d=0;d<a.length;d+=1)e=a[d],e.once&&a.splice(d,1),b.isFunction(e)&&e.apply(null,c)},f=function(b){d(n.events.beforeRegisterEvents,[a,b])},h=function(b){d(n.events.afterRegisterEvents,[a,b])},i=function(b){d(n.events.beforeResolveEvents,[a,b])},j=function(b){d(n.events.afterResolveEvents,[a,b])},k=function(b){d(n.events.beforeNewChildEvents,[a,b])},l=function(b,c){d(n.events.afterNewChildEvents,[a,b,c])},m=function(a){d(n.events.onError,[a])},n.events=o,n.registerEvent=c,n.onError=m,n.beforeRegister=f,n.afterRegister=h,n.beforeResolve=i,n.afterResolve=j,n.beforeNewChild=k,n.afterNewChild=l,n},d=function(d,e,f,h,j){var l,m,n={},o=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,p=/([^\s,]+)/g;return n.HilaryModule=function(a){var b={};if(i.notString(a.name))throw j.argumentException("The module name is required","name");if(i.notDefined(a.factory))throw j.argumentException("The module factory is required","factory");return b.name=a.name,b.dependencies=a.dependencies||void 0,b.factory=a.factory,b},n.asyncHandler=function(a,b){var c=function(){var c;try{c=a()}catch(d){return void(i.isFunction(b)&&b(d))}i.isFunction(b)&&b(null,c)};k?k.nextTick(c):setTimeout&&setTimeout(c,0)},n.createChildContainer=function(a,b){b=b||{};var d;return b.parentContainer=a,f.beforeNewChild(b),d=new c(b),a.registerAsync&&d.useAsync(k),f.afterNewChild(b,d),d},l=function(a){return a.dependencies||"function"!=typeof a.factory?a:(a.dependencies=m(a.factory),a)},m=function(a){if(!a)return[];var b=a.toString().replace(o,""),c=b.slice(b.indexOf("(")+1,b.indexOf(")")).match(p);return null===c&&(c=[]),c},n.register=function(a){if(f.beforeRegister(a),a.name===g.containerRegistration||a.name===g.parentContainerRegistration)throw j.argumentException("The name you are trying to register is reserved","moduleName",a.name);return a=l(a),e[a.name]=a,n.asyncHandler(function(){f.afterRegister(a)}),a},n.resolve=function(a){var b,c;if(i.notString(a))throw j.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveMany.","moduleName");if(f.beforeResolve(a),b=e[a],void 0!==b)return c=n.invoke(b),n.returnResult({name:a,result:c},f);if(c=n.findResult(a))return n.returnResult({name:a,result:c},f);throw j.notResolvableException(a)},n.resolveMany=function(a,b){var c,e,f=[];if(i.notArray(a))throw j.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(i.notFunction(b))throw j.argumentException("The next argument is required and must be a Function","next");for(c=0;c<a.length;c+=1)try{e=d.resolve(a[c]),f.push(e)}catch(g){f.push(g)}return b.apply(null,f)},n.resolveManyAsync=function(a,b){var c,e=[],f={},g=function(a){return function(b){try{f[a]=d.resolve(a),b(null,null)}catch(c){b(c)}}};if(i.notArray(a))throw j.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(i.notFunction(b))throw j.argumentException("The next argument is required and must be a Function","next");for(c=0;c<a.length;c+=1)e.push(g(a[c]));k.parallel(e,function(a){b(a,f)})},n.resolveAsync=function(a,b){var c,d,g,h,l;c=function(b){i.notString(a)?b(j.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveManyAsync.","moduleName")):b(null,null)},d=function(b,c){c(null,f.beforeResolve(a))},g=function(b,c){var d;d=e[a],void 0!==d?n.invokeAsync(d,c):c(null,null)},h=function(b,c){b?c(null,b):c(null,n.findResult(a))},l=function(b,c){b?(f.afterResolve({name:a,result:b}),c(null,b)):c(j.notResolvableException(a))},k.waterfall([c,d,g,h,l],b)},n.findResult=function(c){if(c===g.containerRegistration)return e;if(c===g.parentContainerRegistration)return h.context.getContainer();if(void 0!==h)return h.resolve(c);if(b)try{return b(c)}catch(d){return null}else if(window)return a[c]},n.returnResult=function(a){return n.asyncHandler(function(){f.afterResolve(a)}),a.result},n.invoke=function(a){return i.isArray(a.dependencies)&&a.dependencies.length>0?n.applyDependencies(a):i.isFunction(a.factory)&&0===a.factory.length?a.factory.call():a.factory},n.invokeAsync=function(a,b){return i.isArray(a.dependencies)&&a.dependencies.length>0?void n.applyDependenciesAsync(a,b):void(i.isFunction(a.factory)&&0===a.factory.length?b(null,a.factory.call()):b(null,a.factory))},n.applyDependencies=function(a){var b,c=[],d=function(a){return n.resolve(a)};for(b=0;b<a.dependencies.length;b+=1)c.push(d(a.dependencies[b]));return a.factory.apply(null,c)},n.applyDependenciesAsync=function(a,b){var c,d=[],e=function(a){return function(b){n.resolveAsync(a,b)}};for(c=0;c<a.dependencies.length;c+=1)d.push(e(a.dependencies[c]));k.parallel(d,function(c,d){b(null,a.factory.apply(null,d))})},n.makeAutoRegistrationTasks=function(a,b){var c,d,e=[];if(i.isObject(a)&&(a.name||a.dependencies||a.factory))e.push(function(){b(a).call()});else if(i.isObject(a))for(c in a)a.hasOwnProperty(c)&&e.push(b(a[c]));else{if(!i.isArray(a))throw j.argumentException("A index must be defined and must be a typeof object or array","index");for(d=0;d<a.length;d+=1)e.push(b(a[d]))}return e},n.autoRegister=function(a,b){var c,d,e;c=function(a){return function(){n.register(a)}};try{for(d=n.makeAutoRegistrationTasks(a,c),e=0;e<d.length;e+=1)d[e]();i.isFunction(b)&&b(null)}catch(f){b(f)}},n.autoResolve=function(a,b){var c,e,f;c=function(a){return function(){i.isArray(a.dependencies)&&i.isFunction(a.factory)?d.resolveMany(a.dependencies,a.factory):i.isFunction(a.factory)&&0===a.factory.length&&a.factory()}};try{for(e=n.makeAutoRegistrationTasks(a,c),f=0;f<e.length;f+=1)e[f]();i.isFunction(b)&&b(null,null)}catch(g){b(g)}},n.autoResolveAsync=function(a,b){var c;c=function(a){return function(b){i.isArray(a.dependencies)&&i.isFunction(a.factory)?(d.resolveManyAsync(a.dependencies,a.factory),b(null,null)):i.isFunction(a.factory)&&0===a.factory.length?(a.factory(),b(null,null)):b(j.argumentException("One or more of the items in this index do not meet the requirements for resolution.","index",a))}},k.parallel(n.makeAutoRegistrationTasks(a,c),b)},n.dispose=function(a){var b,c,d;if(i.isString(a))return n.disposeOne(a);if(i.isArray(a)){for(d=!0,c=0;c<a.length;c+=1)d=d&&n.disposeOne(a[c]);return d}if(a)return!1;d=!0;for(b in e)e.hasOwnProperty(b)&&(d=d&&n.disposeOne(b));return d},n.disposeOne=function(a){return e[a]?(delete e[a],!0):!1},n.useAsync=function(a){if(!(a&&a.nextTick&&a.waterfall&&a.parallel))throw j.argumentException("The async library is required (https://www.npmjs.com/package/async)","async");return k||(k=a),d.registerAsync=function(a,b){return n.asyncHandler(function(){return d.register(a)},b),d},d.autoRegisterAsync=function(a,b){var c;return c=function(a){return function(b){d.registerAsync(a,b)}},k.parallel(n.makeAutoRegistrationTasks(a,c),b),d},d.resolveAsync=function(a,b){return n.resolveAsync(a,b),d},d.resolveManyAsync=function(a,b){return n.resolveManyAsync(a,b),d},d.autoResolveAsync=function(a,b){return n.autoResolveAsync(a,b),d},d.disposeAsync=function(a,b){var c=b,e=a;return i.isFunction(a)&&(c=a,e=null),n.asyncHandler(function(){return d.dispose(e)},c),d},d.registerEventAsync=function(a,b,c){return n.asyncHandler(function(){return d.registerEvent(a,b)},c),d},d},n},c=function(a){var b=this,c=a||{},e={},h=c.parentContainer,k=c.pipeline||new f(b,i),o=new j(i,k),p={},q={},r=new d(b,e,k,h,o);for(b.createChildContainer=function(a){var c;return c="string"==typeof a?{name:a}:i.isObject(a)?a:{},r.createChildContainer(b,c)},b.setParentContainer=function(a){"function"==typeof a.register&&"function"==typeof a.resolve&&(h=a,r=new d(b,e,k,h,o))},b.register=function(a){return r.register(new r.HilaryModule(a)),b},b.autoRegister=function(a,c){return r.autoRegister(a,c),b},b.resolve=function(a){return r.resolve(a)},b.resolveMany=function(a,b){return r.resolveMany(a,b)},b.autoResolve=function(a,c){return r.autoResolve(a,c),b},b.dispose=function(a){return r.dispose(a)},b.registerEvent=function(a,c){return k.registerEvent(a,c),b},b.useAsync=function(a){return r.useAsync(a),b},b.getContext=function(){return{container:e,parent:h,pipeline:k,HilaryModule:r.HilaryModule,register:r.register,constants:g,utils:i,exceptionHandlers:o}},p.count=0;p.count<l.length;p.count+=1)p.current=l[p.count],i.isFunction(p.current.factory)?b[p.current.name]=p.current.factory(b):i.isDefined(p.current.factory)&&(b[p.current.name]=p.current.factory);for(q.count=0;q.count<n.length;q.count+=1)q.current=n[q.count],i.isFunction(q.current)&&q.current(b,c);c.name&&(m[c.name]=b)},c.extend=function(a,b){return l.push({name:a,factory:b}),!0},c.onInit=function(a){return n.push(a),!0},c.scope=function(a,b){return m[a]?m[a]:(m[a]=new c(b),m[a])},a.Hilary=c}("undefined"!=typeof module&&module.exports?module.exports:window,"undefined"!=typeof module&&module.exports?require:void 0);