/*! hilary-build 2015-02-22 */
!function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l=[],m=[];g={containerRegistration:"hilary::container",parentContainerRegistration:"hilary::parent",singletons:"__singletons",notResolvable:"hilary::handler::not::resolvable",pipeline:{beforeRegister:"hilary::before::register",afterRegister:"hilary::after::register",beforeResolve:"hilary::before::resolve",afterResolve:"hilary::after::resolve",beforeNewChild:"hilary::before::new::child",afterNewChild:"hilary::after::new::child",onError:"hilary::error"}},h=function(){var a,b,c={},d=Object.prototype,e=d.toString,f=(d.hasOwnProperty,{}),g=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(a=0;a<g.length;a+=1)b=g[a],f["[object "+b+"]"]=b.toLowerCase();return c.type=function(a){return"undefined"==typeof a?"undefined":null===a?String(a):"object"==typeof a||"function"==typeof a?f[e.call(a)]||"object":typeof a},c.notDefined=function(a){try{return"undefined"===this.type(a)}catch(b){return!0}},c.isDefined=function(a){try{return"undefined"!==this.type(a)}catch(b){return!1}},c.isFunction=function(a){return"function"===this.type(a)},c.notFunction=function(a){return"function"!==this.type(a)},c.isObject=function(a){return"object"===this.type(a)},c.notObject=function(a){return"object"!==this.type(a)},c.isArray=function(a){return"array"===this.type(a)},c.notArray=function(a){return"array"!==this.type(a)},c.isString=function(a){return"string"===this.type(a)},c.notString=function(a){return"string"!==this.type(a)},c.isBoolean=function(a){return"boolean"===this.type(a)},c.notBoolean=function(a){return"boolean"!==this.type(a)},c.notNullOrWhitespace=function(a){if(!a)return!1;if(this.notString(a))throw new Error("Unable to check if a non-string is whitespace.");return/([^\s])/.test(a)},c.isNullOrWhitespace=function(a){return this.notNullOrWhitespace(a)===!1},c.createGuid=function(){return"zxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},c},i=new h,j=function(a,b){var c,d={};return c=function(c,d,e){var f=a.isString(d)?d:c,g=new Error(f);return g.message=f,c!==f&&(g.name=c),e&&(g.data=e),b.onError(g),g},d.makeException=c,d.argumentException=function(b,d,e){var f=a.notDefined(d)?b:b+" (argument: "+d+")";return c("ArgumentException",f,e)},d.dependencyException=function(b,d,e){var f=a.notDefined(d)?b:b+" (dependency: "+d+"). If the module exists, does it return a value?";return c("DependencyException",f,e)},d.notImplementedException=function(a,b){return c("NotImplementedException",a,b)},d.notResolvableException=function(a){return d.dependencyException("The module cannot be resolved",a)},d},e=function(){var a={};return a.beforeRegisterEvents=[],a.afterRegisterEvents=[],a.beforeResolveEvents=[],a.afterResolveEvents=[],a.beforeNewChildEvents=[],a.afterNewChildEvents=[],a.onError=[],a},f=function(a,b){var c,d,f,h,i,j,k,l,m,n={},o=new e;return c=function(b,c){switch(b){case g.pipeline.beforeRegister:return o.beforeRegisterEvents.push(c),a;case g.pipeline.afterRegister:return o.afterRegisterEvents.push(c),a;case g.pipeline.beforeResolve:return o.beforeResolveEvents.push(c),a;case g.pipeline.afterResolve:return o.afterResolveEvents.push(c),a;case g.pipeline.beforeNewChild:return o.beforeNewChildEvents.push(c),a;case g.pipeline.afterNewChild:return o.afterNewChildEvents.push(c),a;case g.pipeline.onError:return o.onError.push(c),a;default:throw new Error("the pipeline event you are trying to register is not implemented (name: "+b+")")}},d=function(a,c){var d,e;for(d=0;d<a.length;d+=1)e=a[d],e.once&&a.splice(d,1),b.isFunction(e)&&e.apply(null,c)},f=function(b){d(n.events.beforeRegisterEvents,[a,b])},h=function(b){d(n.events.afterRegisterEvents,[a,b])},i=function(b){d(n.events.beforeResolveEvents,[a,b])},j=function(b){d(n.events.afterResolveEvents,[a,b])},k=function(b){d(n.events.beforeNewChildEvents,[a,b])},l=function(b,c){d(n.events.afterNewChildEvents,[a,b,c])},m=function(a){d(n.events.onError,[a])},n.events=o,n.registerEvent=c,n.onError=m,n.beforeRegister=f,n.afterRegister=h,n.beforeResolve=i,n.afterResolve=j,n.beforeNewChild=k,n.afterNewChild=l,n},d=function(d,e,f,h,j){var l={};return l.HilaryModule=function(a){var b={};if(i.notString(a.name))throw j.argumentException("The module name is required","name");if(i.notDefined(a.factory))throw j.argumentException("The module factory is required","factory");return b.name=a.name,b.dependencies=a.dependencies||void 0,b.factory=a.factory,b},l.asyncHandler=function(a,b){var c=function(){var c;try{c=a()}catch(d){return void(i.isFunction(b)&&b(d))}i.isFunction(b)&&b(null,c)};k?k.nextTick(c):setTimeout&&setTimeout(c,0)},l.createChildContainer=function(a,b){b=b||{};var d,e;return d={parentContainer:a},f.beforeNewChild(d),e=new c(d),a.registerAsync&&e.useAsync(k),f.afterNewChild(d,e),e},l.register=function(a){if(f.beforeRegister(a),a.name===g.containerRegistration||a.name===g.parentContainerRegistration)throw j.argumentException("The name you are trying to register is reserved","moduleName",a.name);return e[a.name]=a,l.asyncHandler(function(){f.afterRegister(a)}),a},l.resolve=function(a){var b,c;if(i.notString(a))throw j.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveMany.","moduleName");if(f.beforeResolve(a),b=e[a],void 0!==b)return c=l.invoke(b),l.returnResult({name:a,result:c},f);if(c=l.findResult(a))return l.returnResult({name:a,result:c},f);throw j.notResolvableException(a)},l.resolveMany=function(a,b){var c,e,f=[];if(i.notArray(a))throw j.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(i.notFunction(b))throw j.argumentException("The next argument is required and must be a Function","next");for(c=0;c<a.length;c+=1)try{e=d.resolve(a[c]),f.push(e)}catch(g){f.push(g)}return b.apply(null,f)},l.resolveManyAsync=function(a,b){var c,e=[],f={},g=function(a){return function(b){try{f[a]=d.resolve(a),b(null,null)}catch(c){b(c)}}};if(i.notArray(a))throw j.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(i.notFunction(b))throw j.argumentException("The next argument is required and must be a Function","next");for(c=0;c<a.length;c+=1)e.push(g(a[c]));k.parallel(e,function(a){b(a,f)})},l.resolveAsync=function(a,b){var c,d,g,h,m;c=function(b){i.notString(a)?b(j.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveManyAsync.","moduleName")):b(null,null)},d=function(b,c){c(null,f.beforeResolve(a))},g=function(b,c){var d;d=e[a],void 0!==d?l.invokeAsync(d,c):c(null,null)},h=function(b,c){b?c(null,b):c(null,l.findResult(a))},m=function(b,c){b?(f.afterResolve({name:a,result:b}),c(null,b)):c(j.notResolvableException(a))},k.waterfall([c,d,g,h,m],b)},l.findResult=function(c){if(c===g.containerRegistration)return e;if(c===g.parentContainerRegistration)return h.context.getContainer();if(void 0!==h)return h.resolve(c);if(b)try{return b(c)}catch(d){return null}else if(window)return a[c]},l.returnResult=function(a){return l.asyncHandler(function(){f.afterResolve(a)}),a.result},l.invoke=function(a){return i.isArray(a.dependencies)&&a.dependencies.length>0?l.applyDependencies(a):i.isFunction(a.factory)&&0===a.factory.length?a.factory.call():a.factory},l.invokeAsync=function(a,b){return i.isArray(a.dependencies)&&a.dependencies.length>0?void l.applyDependenciesAsync(a,b):void(i.isFunction(a.factory)&&0===a.factory.length?b(null,a.factory.call()):b(null,a.factory))},l.applyDependencies=function(a){var b,c=[],d=function(a){return l.resolve(a)};for(b=0;b<a.dependencies.length;b+=1)c.push(d(a.dependencies[b]));return a.factory.apply(null,c)},l.applyDependenciesAsync=function(a,b){var c,d=[],e=function(a){return function(b){l.resolveAsync(a,b)}};for(c=0;c<a.dependencies.length;c+=1)d.push(e(a.dependencies[c]));k.parallel(d,function(c,d){b(null,a.factory.apply(null,d))})},l.makeAutoRegistrationTasks=function(a,b){var c,d,e=[];if(i.isObject(a)&&(a.name||a.dependencies||a.factory))e.push(function(){b(a).call()});else if(i.isObject(a))for(c in a)a.hasOwnProperty(c)&&e.push(b(a[c]));else{if(!i.isArray(a))throw j.argumentException("A index must be defined and must be a typeof object or array","index");for(d=0;d<a.length;d+=1)e.push(b(a[d]))}return e},l.autoRegister=function(a,b){var c,d,e;c=function(a){return function(){l.register(a)}};try{for(d=l.makeAutoRegistrationTasks(a,c),e=0;e<d.length;e+=1)d[e]();i.isFunction(b)&&b(null)}catch(f){b(f)}},l.autoResolve=function(a,b){var c,e,f;c=function(a){return function(){i.isArray(a.dependencies)&&i.isFunction(a.factory)?d.resolveMany(a.dependencies,a.factory):i.isFunction(a.factory)&&0===a.factory.length&&a.factory()}};try{for(e=l.makeAutoRegistrationTasks(a,c),f=0;f<e.length;f+=1)e[f]();i.isFunction(b)&&b(null,null)}catch(g){b(g)}},l.autoResolveAsync=function(a,b){var c;c=function(a){return function(b){i.isArray(a.dependencies)&&i.isFunction(a.factory)?(d.resolveManyAsync(a.dependencies,a.factory),b(null,null)):i.isFunction(a.factory)&&0===a.factory.length?(a.factory(),b(null,null)):b(j.argumentException("One or more of the items in this index do not meet the requirements for resolution.","index",a))}},k.parallel(l.makeAutoRegistrationTasks(a,c),b)},l.dispose=function(a){var b,c,d;if(i.isString(a))return l.disposeOne(a);if(i.isArray(a)){for(d=!0,c=0;c<a.length;c+=1)d=d&&l.disposeOne(a[c]);return d}if(a)return!1;d=!0;for(b in e)e.hasOwnProperty(b)&&(d=d&&l.disposeOne(b));return d},l.disposeOne=function(a){return e[a]?(delete e[a],!0):!1},l.useAsync=function(a){if(!(a&&a.nextTick&&a.waterfall&&a.parallel))throw j.argumentException("The async library is required (https://www.npmjs.com/package/async)","async");return k||(k=a),d.registerAsync=function(a,b){return l.asyncHandler(function(){return d.register(a)},b),d},d.autoRegisterAsync=function(a,b){var c;return c=function(a){return function(b){d.registerAsync(a,b)}},k.parallel(l.makeAutoRegistrationTasks(a,c),b),d},d.resolveAsync=function(a,b){return l.resolveAsync(a,b),d},d.resolveManyAsync=function(a,b){return l.resolveManyAsync(a,b),d},d.autoResolveAsync=function(a,b){return l.autoResolveAsync(a,b),d},d.disposeAsync=function(a,b){var c=b,e=a;return i.isFunction(a)&&(c=a,e=null),l.asyncHandler(function(){return d.dispose(e)},c),d},d.registerEventAsync=function(a,b,c){return l.asyncHandler(function(){return d.registerEvent(a,b)},c),d},d},l},c=function(a){var b=this,c=a||{},e={},h=c.parentContainer,k=c.pipeline||new f(b,i),n=new j(i,k),o={},p={},q=new d(b,e,k,h,n);for(b.createChildContainer=function(a){return q.createChildContainer(b,a,c)},b.register=function(a){return q.register(new q.HilaryModule(a)),b},b.autoRegister=function(a,c){return q.autoRegister(a,c),b},b.resolve=function(a){return q.resolve(a)},b.resolveMany=function(a,b){return q.resolveMany(a,b)},b.autoResolve=function(a,c){return q.autoResolve(a,c),b},b.dispose=function(a){return q.dispose(a)},b.registerEvent=function(a,c){return k.registerEvent(a,c),b},b.useAsync=function(a){return q.useAsync(a),b},b.getContext=function(){return{container:e,parent:h,HilaryModule:q.HilaryModule,register:q.register,constants:g,utils:i,exceptionHandlers:n}},o.count=0;o.count<l.length;o.count+=1)o.current=l[o.count],i.isFunction(o.current.factory)?b[o.current.name]=o.current.factory(b):i.isDefined(o.current.factory)&&(b[o.current.name]=o.current.factory);for(p.count=0;p.count<m.length;p.count+=1)p.current=m[p.count],i.isFunction(p.current)&&p.current(b,c)},c.extend=function(a,b){return l.push({name:a,factory:b}),!0},c.onInit=function(a){return m.push(a),!0},a.Hilary=c}("undefined"!=typeof module&&module.exports?module.exports:window,"undefined"!=typeof module&&module.exports?require:void 0);